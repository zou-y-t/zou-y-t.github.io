# 2024/7/9
# 算法交易 Algorithmic Trading
利用自动化平台，执行预先设置的一系列规则完成交易行为
量化交易是其一部分--from data
## 优势
1. 历史数据评估（基于以前的庞大的历史数据）
2. 执行高效（自动化平台）
3. 无主观情绪输入（客观的，仅仅依赖于预先设计的规则）
4. 可度量评价（数据说话）
5. 交易频率（频率高）
## 劣势
1. 成本（时间和金钱成本，需要投入的金钱成本是比较高的）
2. 技巧（需要比较强的数学和编程背景）
## 流程
大前提：基于某种平台
1. 提出假设：提出任何假设，eg：在A情况下，股票会涨
2. 建立模型：基于假设建立模型
3. 回测验证：在历史数据上验证假设
4. 执行交易
## 交易策略的来源（重点）
1. 市场微观结构研究（比较高端，微观尺度上对产品的价格进行预测）
2. 基金结构套利（大宗买卖会有pattern）
3. 机器学习/人工智能（基于大量的历史数据，大多数所采用的）
- 微观结构
  - order：下单的时候：
    - Bid/Ask（买/卖）
    - symbol（买/卖的哪支股票）
    - shares（数股票量）
    - limit/market（限价单/市价单）
      - **Limit Book（限价单簿）**：
        - `Limit Book`是指包含所有限价单的订单簿。限价单是指交易者指定一个特定价格来买入或卖出股票的订单。只有当市场价格达到或超过这个指定价格时，订单才会被执行。
        - 例如，如果你设置了一个买入限价单，只有当股票价格降到或低于你指定的价格时，订单才会被执行。

      - **Market Out（市价单）**：
        - `Market Out` 是指市价单，即按照当前市场价格立即执行的订单。市价单不指定价格，而是以当前市场上最优的价格立即买入或卖出股票。
        - 例如，如果你设置了一个市价单买入，订单会以当前市场上最优的卖出价格立即执行。
    - price（股票撮合之后的价格）
  - ORDER BOOK
    - 会记录买卖（买一买二卖一卖二：买由高往低，卖由低往高，必须由卖价的最低和买价的最高交易）
就是根据ORDER BOOK来预测接下来的price的走向
## 机器学习流程
```
输入---->函数(模型)---->输出
        BLACK
        BOX
```
需要
- data
- model&object function
- optimization（优化，寻找object function的极值）
### 函数来源
函数内部有很多参数[w1,w2,w3,w4,...,wn]
training：历史数据---->学习算法---->模型
预测：新的输入---->模型---->输出
难点：选择features，训练出模型，利用分类器
### 主流流派
Connectionism联接主义   eg:神经网络，黑盒模型
Symbolism符号主义   eg:决策树，有可解释性
Frequentism频率主义
Bayesian贝叶斯学派
## 机器学习和量化交易
### Limit Order Book Modeling（限价单簿建模）
限价单簿（LOB）是一个包含所有未成交限价单的订单簿。限价单是指交易者指定一个特定价格来买入或卖出股票的订单。限价单簿建模涉及对这些订单簿的数据进行分析和建模，以预测市场行为和价格走势。
### Price-Based Classification Models（基于价格的分类模型）
基于价格的分类模型使用历史价格数据来预测未来的价格走势或分类市场状态。这些模型可以包括简单的移动平均线、支持向量机（SVM）、随机森林等，用于识别价格模式和趋势。
### Text-Based Classification Models（基于文本的分类模型）
基于文本的分类模型使用自然语言处理（NLP）技术来分析和分类文本数据，例如新闻文章、社交媒体帖子等。这些模型可以用于情感分析、主题分类等，以预测市场情绪和潜在的市场影响。
### Reinforcement Learning（强化学习）
强化学习是一种机器学习方法，通过与环境的交互来学习最佳策略。它通过奖励和惩罚机制来优化决策过程。在金融领域，强化学习可以用于开发自动交易策略，通过不断调整策略来最大化收益。
关键问题：噪声的处理
## KEY FACTORS
- good model and efficient training algorithm(纯ML)
- hardware(GPU/CPU)
- high quality data(噪声小)
- platform(keras/tensorflow/sklearn)
## 深度学习
神经网络超过两层都可以算
- CNN for spatial data（空间）
- LSTM for temporal data（时间）
（HMM没有LSTM好，难以处理比较大的数据）
## 强化学习
假设已经有的了一个环境，每次Agent都会选择一个策略(Policy)，给环境一个行为(action)，环境会给Agent一个反馈(Reward)，要做的就是寻找最好的Policy，让Reward最大
## NLP
关键技术：word---->vector
文本--->编码器--->向量x--->Model--->Y
编码的话，调用api就OK，相关库：gensim
## 怎么定义input features
- 特征工程（我根据经验觉得xx比较重要）
- 特征选择（重要。从原始数据集中选择出最有用的特征，以提高模型的性能和可解释性）

不能做时间旅行了！只能提取当前时刻前的量！否则回测数据会非常好，但是实战可能会很差！
## 交易策略的评估
这个是easy part
1. 策略基本假设
2. sharp ratio
3. 杠杆
4. 频率
5. 风险
6. W/L
7. 模型复杂度
8. 最大亏损（Maxium drawdown）
9. Benchmarking
## 回测
将交易策略在历史数据中进行合理验证的过程
- 策略筛选
- 策略优化
- 策略验证

常见的错误：
1. 乐观主义偏差（special look back region）
2. 时间旅行
   1. 程序BUG
   2. Train/Val/Test set
3. 幸存者偏差
## 工具
sklearn，pandas...
