# 2024/7/10
# 从技术分析到机器学习
## 常用库
- 线性代数：numpy
- pandas：更高效，统计指标、绘图
- sklearn：除了深度学习和强化学习的模型，基本都有
## CAPM Model
$r_i(t)=\beta _i*r_m(t)+\alpha _i(t)$
- $r_i(t)$：目标变量，表示资产 \( i \) 在时间 \( t \) 的回报率。
- $r_m(t)$：解释变量，表示市场组合在时间 \( t \) 的回报率。
- $\beta _i$：解释变量的系数，表示资产 \( i \) 对市场回报的敏感度。
- $\alpha _i(t)$：截距项或误差项，表示资产 \( i \) 在时间 \( t \) 的超额回报。

个股的收益是和股票大盘成线性的关系

CAPM的理论期望$E(\alpha (t))=0$
### 被动式管理&主动式管理
被动式：复制大盘指数，持有，认为期望是0
主动式：选择个股，频繁交易，认为期望不是0
关键分歧：alpha是否是随机噪声，期望是不是0
### 投资组合的CAPM模型
$r_p(t)=\sum_{i} w_i(\beta_ir_m(t)+\alpha_i(t))$
==>
$r_p(t) = \beta_p \cdot r_m(t) + \alpha_p(t)$
### 推论
$E(\alpha)=0$

选择好的$\beta$值
- 牛市：大$\beta$
- 熊市：小$\beta$
### APT（套利定价理论）
APT（Arbitrage Pricing Theory，套利定价理论）是一种资产定价模型，它假设资产的回报可以由多个宏观经济因素驱动。APT模型的基本公式如下：

$r_i = \alpha_i + \sum_{j=1}^{k} \beta_{ij} F_j + \epsilon_i$

其中：
- $r_i$：资产 $i$ 的回报率。
- $\alpha_i$：资产 $i$ 的截距项或超额回报。
- $\beta_{ij}$：资产 $i$ 对第 $j$ 个因素的敏感度（因子负荷）。
- $F_j$：第 $j$ 个宏观经济因素的回报。
- $\epsilon_i$：资产 $i$ 的特有风险（误差项）。
- $k$：宏观经济因素的数量。

APT模型的核心思想是，通过选择多个宏观经济因素，可以更准确地描述资产的回报率。与CAPM模型不同，APT模型不需要假设市场是完全有效的，也不需要假设投资者的期望是相同的。
### 技术分析&基本面分析
- 历史数据
  - 价格，交易量
  - 计算指标（features）
  - 启发式选择features（经验，机器学习）

技术分析有用的时候：
- 多个指标的组合
- 短时（一般在日内）
- 异类监测

### 最基本的指标以及机器学习如何介入
- Momentum动量线 $\text{Momentum}(t) = \text{price}(t) - \text{price}(t-n)$
- SMA简单移动平均线 $\text{SMA}(t) = \frac{1}{n} \sum_{i=0}^{n-1} \text{price}(t-i)$用于平滑价格数据
- BB布林带
  - 中轨线 $\text{Middle Band} = \text{SMA}(t)$
  - 上轨线 $\text{Upper Band} = \text{SMA}(t) + k \cdot \text{Standard Deviation}(t)$
  - 下轨线 $\text{Lower Band} = \text{SMA}(t) - k \cdot \text{Standard Deviation}(t)$
  - k一般取值为2
- $y=f(MOM,SMA,BB)$
### KNN模型
KNN（K-Nearest Neighbors，K近邻）模型是一种用于分类和回归的监督学习算法。其基本步骤如下：
1. 计算待分类样本与训练集中所有样本的距离。
2. 按照距离从小到大排序，选择距离最近的 \(K\) 个样本。
3. 对于分类任务，使用这 \(K\) 个样本中出现次数最多的类别作为预测结果；对于回归任务，使用这 \(K\) 个样本的平均值作为预测结果。
### 偏差-方差权衡（Bias-Variance Trade-off）
偏差-方差权衡是机器学习中的一个重要概念，用于描述模型的复杂度与其在训练数据和测试数据上的表现之间的关系。

- 偏差（Bias）
偏差是指模型预测值与真实值之间的误差。高偏差通常意味着模型过于简单，无法捕捉数据的复杂模式，导致欠拟合（underfitting）。

- 方差（Variance）
方差是指模型对训练数据的敏感程度。高方差通常意味着模型过于复杂，过度拟合（overfitting）训练数据，导致在新数据上的表现不佳。

- 权衡
  - **高偏差、低方差**：模型简单，训练数据和测试数据上的误差都较大，表现为欠拟合。
  - **低偏差、高方差**：模型复杂，训练数据上的误差较小，但测试数据上的误差较大，表现为过拟合。
  - **适中偏差、适中方差**：模型在训练数据和测试数据上都有较好的表现，达到较好的泛化能力。

在实际应用中，选择合适的模型复杂度以达到偏差和方差之间的平衡是至关重要的。